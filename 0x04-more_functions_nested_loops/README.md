this contains more C funtions and nested loops
